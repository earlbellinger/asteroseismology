C     TO EVALUATE ERROR FUNCTION AND COMPLEMENTARY ERROR FUNCTION

      PROGRAM ERROR
      IMPLICIT REAL*8(A-H,O-Z)
      EXTERNAL ERF,ERFC
 
51    FORMAT('   X =',1PD14.6,5X,'ERF(X) =',D14.6,5X,
     1       'ERFC(X) =',D14.6)

 
100   PRINT *,'TYPE X    (QUITS WHEN X<-1000)'
      READ *,X
      IF(X.LT.-1000) STOP
      F1=ERF(X)
      F2=ERFC(X)
      WRITE(6,51) X,F1,F2
      GO TO 100
      END
 
C     ----------------------------------------------------
 
C	To calculate the Error function for a real argument
C
C	Required routines : None
 
      FUNCTION ERF(X)
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION A(7),B(8),A1(7),B1(8)

C	The coefficients of rational function approximations
      DATA A/ 4.891837297874833514D-01,  1.110175596090841322D-01,
     1        1.526977188817169289D-02,  1.388143322498740953D-03,
     1        8.446154421878829637D-05,  3.239915935631695227D-06,
     1        6.200069065781009292D-08/
      DATA B/ 1.128379167095512575D+00,  1.758583405424390318D-01,
     1        5.411290829613803886D-02,  3.805760982281134630D-03,
     1        4.314620532020313106D-04,  1.423201530735308681D-05,
     1        6.188698151904667110D-07,  2.293915472550064153D-09/
      DATA A1/ 3.040844316651787557D+01,  3.358927547920980388D+02,
     1         1.703170048554673596D+03,  4.133195606956137156D+03,
     1         4.555611776312694034D+03,  1.935778559646575488D+03,
     1         2.051089518116697193D+02/
      DATA B1/ 5.641895835477562749D-01,  1.687403209467950089D+01,
     1         1.813522721872712655D+02,  8.779664433851135986D+02,
     1         1.965115658619443782D+03,  1.865558781108286245D+03,
     1         5.828865035607128761D+02,  2.558559157228883880D+01/
 
      IF(ABS(X).LT.2.0) THEN
C	Use approximation for Erf(x)/x
        Y=X*X
        FN=((((((B(8)*Y+B(7))*Y+B(6))*Y+B(5))*Y+B(4))*Y+B(3))*Y+B(2))*Y
     1      +B(1)
        FD=((((((A(7)*Y+A(6))*Y+A(5))*Y+A(4))*Y+A(3))*Y+A(2))*Y
     1      +A(1))*Y+1
        ERF=X*FN/FD
      ELSE
 
C	Use approximation for x*Exp(x^2)*Erfc(x)
        X1=1./X**2
        FN=((((((B1(8)*X1+B1(7))*X1+B1(6))*X1+B1(5))*X1+B1(4))*X1+
     1      B1(3))*X1+B1(2))*X1+B1(1)
        FD=((((((A1(7)*X1+A1(6))*X1+A1(5))*X1+A1(4))*X1+A1(3))*X1+
     1      A1(2))*X1+A1(1))*X1+1
        ERF=1.-EXP(-X*X)*FN/(FD*ABS(X))
        IF(X.LT.0.0) ERF=-ERF
      ENDIF
 
      END
 
C     ----------------------------------------------------
 
C	To calculate the complementary Error function for a real argument
C
C	Required routines : None
 
      FUNCTION ERFC(X)
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION A(7),B(8),A1(7),B1(8)

C	The coefficients of rational function approximations
      DATA A/ 4.891837297874833514D-01,  1.110175596090841322D-01,
     1        1.526977188817169289D-02,  1.388143322498740953D-03,
     1        8.446154421878829637D-05,  3.239915935631695227D-06,
     1        6.200069065781009292D-08/
      DATA B/ 1.128379167095512575D+00,  1.758583405424390318D-01,
     1        5.411290829613803886D-02,  3.805760982281134630D-03,
     1        4.314620532020313106D-04,  1.423201530735308681D-05,
     1        6.188698151904667110D-07,  2.293915472550064153D-09/
      DATA A1/ 3.040844316651787557D+01,  3.358927547920980388D+02,
     1         1.703170048554673596D+03,  4.133195606956137156D+03,
     1         4.555611776312694034D+03,  1.935778559646575488D+03,
     1         2.051089518116697193D+02/
      DATA B1/ 5.641895835477562749D-01,  1.687403209467950089D+01,
     1         1.813522721872712655D+02,  8.779664433851135986D+02,
     1         1.965115658619443782D+03,  1.865558781108286245D+03,
     1         5.828865035607128761D+02,  2.558559157228883880D+01/
 
      IF(ABS(X).LT.2.0) THEN
C	Use approximation to Erf(x)/x
        Y=X*X
        FN=((((((B(8)*Y+B(7))*Y+B(6))*Y+B(5))*Y+B(4))*Y+B(3))*Y+B(2))*Y
     1      +B(1)
        FD=((((((A(7)*Y+A(6))*Y+A(5))*Y+A(4))*Y+A(3))*Y+A(2))*Y
     1      +A(1))*Y+1
        ERFC=1.-X*FN/FD
      ELSE
 
C	Use approximation to x*Exp(x^2)*Erfc(x)
        X1=1./X**2
        FN=((((((B1(8)*X1+B1(7))*X1+B1(6))*X1+B1(5))*X1+B1(4))*X1+
     1      B1(3))*X1+B1(2))*X1+B1(1)
        FD=((((((A1(7)*X1+A1(6))*X1+A1(5))*X1+A1(4))*X1+A1(3))*X1+
     1      A1(2))*X1+A1(1))*X1+1
        ERFC=EXP(-X*X)*FN/(FD*ABS(X))
        IF(X.LT.0) ERFC=2.-ERFC
      ENDIF
 
      END
