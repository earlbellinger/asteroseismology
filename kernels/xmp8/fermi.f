C     TO EVALUATE FERMI INTEGRALS FOR K = -1/2, 1/2, 3/2, 5/2

      PROGRAM FERMI
      IMPLICIT REAL*8(A-H,O-Z)
 
51    FORMAT('   X =',1PD14.6,5X,'F(-1/2,X) =',D14.6,5X,
     1       'F(1/2,X) =',D14.6/5X,'F(3/2,X) =',D14.6,5X,
     2       'F(5/2,X) =',D14.6)
 
100   PRINT *,'TYPE X    (QUITS WHEN X<-1000)'
      READ *,X
      IF(X.LT.-1000) STOP
      F1=FERMM05(X)
      F2=FERM05(X)
      F3=FERM15(X)
      F4=FERM25(X)
      WRITE(6,51) X,F1,F2,F3,F4
      GO TO 100
      END
 
C     ----------------------------------------------------
 
C	To calculate the Fermi integral for k=-1/2 for real argument
C
C	Required routines : None
 
      FUNCTION FERMM05(X)
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION A(9),B(10),A1(9),B1(10),A2(9),B2(10)
 
C	Coefficients of rational function approximations
      DATA A/  3.633183036310193702D+00,  5.335383253918690131D+00,
     1         4.079430052048247651D+00,  1.747906909036781697D+00,
     1         4.223506094680981781D-01,  5.537045655151334865D-02,
     1         3.607687989219176229D-03,  9.850347648293245268D-05,
     1         7.606021916949652951D-07/
      DATA B/  1.772453850905514416D+00,  5.186335126437444887D+00,
     1         5.926527639536391534D+00,  3.375396555770695396D+00,
     1         1.017957982472663391D+00,  1.604474074050487190D-01,
     1         1.230542884288290881D-02,  3.933239725620379548D-04,
     1         3.650440948497754449D-06,  9.742113007928913705D-10/
 
      DATA A1/  2.380598901582346509D-01,  1.948363117668486933D-01,
     1          3.187787885725001684D-02,  1.038176041451691336D-02,
     1          9.406874895006179971D-04,  1.135842036525309239D-04,
     1          7.299137534044266613D-06,  2.523032117352548804D-07,
     1          9.717901643992206546D-10/
      DATA B1/  1.072147023123106661D+00,  9.289962788104335480D-01,
     1          4.743603973028633253D-01,  1.646743468291735872D-01,
     1          3.969089819062670372D-02,  6.726576928071186234D-03,
     1          6.634259351526833300D-04,  6.124666031703230112D-05,
     1          3.150683483005771954D-06,  4.772635816406201002D-08/
 
      DATA A2/  3.702223911108869908D+02,  2.598723392323324771D+05,
     1          6.353495373811685919D+07,  1.458761697561901484D+10,
     1          1.726490095322560109D+12,  1.400495505156701097D+14,
     1          5.452693736065907221D+15,  9.561693114496315040D+16,
     1          4.481875529096675825D+17/
      DATA B2/  2.000000000000001084D+00,  7.396223151882119455D+02,
     1          5.194366313824900668D+05,  1.268547980181480670D+08,
     1          2.912203205913661556D+10,  3.440740530019870938D+12,
     1          2.786232053682433961D+14,  1.078287645942363898D+16,
     1          1.861949241347277040D+17,  7.588754613723405446D+17/
 
 
      IF(X.LT.2.0) THEN
        Y=EXP(X)
        FN=((((((((B(10)*Y+B(9))*Y+B(8))*Y+B(7))*Y+B(6))*Y+B(5))*Y
     1             +B(4))*Y+B(3))*Y+B(2))*Y+B(1)
        FD=((((((((A(9)*Y+A(8))*Y+A(7))*Y+A(6))*Y+A(5))*Y+A(4))*Y+
     1             A(3))*Y+A(2))*Y+A(1))*Y+1
        FERMM05=Y*FN/FD
 
      ELSE IF(X.LT.10.0) THEN
        FN=((((((((B1(10)*X+B1(9))*X+B1(8))*X+B1(7))*X+B1(6))*X+
     1             B1(5))*X+B1(4))*X+B1(3))*X+B1(2))*X+B1(1)
        FD=((((((((A1(9)*X+A1(8))*X+A1(7))*X+A1(6))*X+A1(5))*X+A1(4))*X
     1             +A1(3))*X+A1(2))*X+A1(1))*X+1
        FERMM05=FN/FD
 
      ELSE
        Y=1./X**2
        FN=((((((((B2(10)*Y+B2(9))*Y+B2(8))*Y+B2(7))*Y+B2(6))*Y+B2(5))*Y
     1             +B2(4))*Y+B2(3))*Y+B2(2))*Y+B2(1)
        FD=((((((((A2(9)*Y+A2(8))*Y+A2(7))*Y+A2(6))*Y+A2(5))*Y+A2(4))*Y+
     1             A2(3))*Y+A2(2))*Y+A2(1))*Y+1
        FERMM05=SQRT(X)*FN/FD
      ENDIF
 
      END
 
C     ----------------------------------------------------
 
C	To calculate the Fermi integral for k=1/2 for real argument
C
C	Required routines : None
 
      FUNCTION FERM05(X)
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION A(9),B(10),A1(9),B1(10),A2(8),B2(9)
 
C	Coefficients of rational function approximations
      DATA A/  3.302620934271337588D+00,  4.378312090750206777D+00,
     1         2.999885885327892603D+00,  1.142917097324546507D+00,
     1         2.435745203546323236D-01,  2.791956018125755158D-02,
     1         1.574175318764382964D-03,  3.664973020658509037D-05,
     1         2.346904340445329108D-07/
      DATA B/  8.862269254527574101D-01,  2.613543062186459172D+00,
     1         3.015927137398690065D+00,  1.739227870401479058D+00,
     1         5.330822697713709794D-01,  8.586264526687773647D-02,
     1         6.788394858177185501D-03,  2.274054435973081876D-04,
     1         2.315801842674568714D-06,  1.633085206967838891D-09/
 
      DATA A1/  2.966963706974223470D-01,  1.810136368787938030D-01,
     1          3.209472553909511737D-02,  8.018646702814360411D-03,
     1          6.211980386042466081D-04,  6.792187282517725491D-05,
     1          3.535044027227577225D-06,  2.067780549030282364D-08,
     1         -3.696843108869046291D-11/
      DATA B1/  6.780980178378758954D-01,  7.372425434166232101D-01,
     1          4.502852753072012975D-01,  1.862085214442629192D-01,
     1          5.519062354389068922D-02,  1.154662947767231818D-02,
     1          1.709071687204553302D-03,  1.245202776657164504D-04,
     1          1.282519479810464212D-05,  2.585227363626036358D-07/
 
      DATA A2/ -5.731200755185620178D+00,  1.015080722768952764D+05,
     1          8.269267895493730982D+05,  1.660227300554511680D+09,
     1         -1.412551344815020252D+10,  3.238977147316021775D+12,
     1         -6.400117438754161869D+13,  8.379214798647386671D+13/
      DATA B2/  6.666666666666671693D-01, -2.998333470070368622D+00,
     1          6.766804473599422614D+04,  6.347739642090437557D+05,
     1          1.107570549042908293D+09, -8.050283273382635156D+09,
     1          2.148908087876750353D+12, -4.000483321273162995D+13,
     1          6.575814097228241929D+12/
 
 
      IF(X.LT.2.0) THEN
        Y=EXP(X)
        FN=((((((((B(10)*Y+B(9))*Y+B(8))*Y+B(7))*Y+B(6))*Y+B(5))*Y
     1            +B(4))*Y+B(3))*Y+B(2))*Y+B(1)
        FD=((((((((A(9)*Y+A(8))*Y+A(7))*Y+A(6))*Y+A(5))*Y+A(4))*Y+
     1            A(3))*Y+A(2))*Y+A(1))*Y+1
        FERM05=Y*FN/FD
 
      ELSE IF(X.LT.10.0) THEN
        FN=((((((((B1(10)*X+B1(9))*X+B1(8))*X+B1(7))*X+B1(6))*X+
     1            B1(5))*X+B1(4))*X+B1(3))*X+B1(2))*X+B1(1)
        FD=((((((((A1(9)*X+A1(8))*X+A1(7))*X+A1(6))*X+A1(5))*X+A1(4))*X
     1            +A1(3))*X+A1(2))*X+A1(1))*X+1
        FERM05=FN/FD
 
      ELSE
        Y=1./X**2
        FN=(((((((B2(9)*Y+B2(8))*Y+B2(7))*Y+B2(6))*Y+B2(5))*Y
     1            +B2(4))*Y+B2(3))*Y+B2(2))*Y+B2(1)
        FD=(((((((A2(8)*Y+A2(7))*Y+A2(6))*Y+A2(5))*Y+A2(4))*Y+
     1            A2(3))*Y+A2(2))*Y+A2(1))*Y+1
        FERM05=X**1.5D0*FN/FD
      ENDIF
 
      END
 
C     ----------------------------------------------------
 
C	To calculate the Fermi integral for k=3/2 for real argument
C
C	Required routines : None
 
      FUNCTION FERM15(X)
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION A(9),B(10),A1(9),B1(10),A2(7),B2(8)
 
C	Coefficients of rational function approximations
      DATA A/  2.941809147359585304D+00,  3.439655290706647512D+00,
     1         2.056145556774501803D+00,  6.754795354745318686D-01,
     1         1.225806771429525260D-01,  1.180305150936387470D-02,
     1         5.504405550395816910D-04,  1.038731891696509330D-05,
     1         5.207633334112564377D-08/
      DATA B/  1.329340388179136083D+00,  3.675669313153495924D+00,
     1         3.966435363691792986D+00,  2.134338154956892860D+00,
     1         6.096513425515978847D-01,  9.154989439790675352D-02,
     1         6.772074110214310551D-03,  2.144157491371981044D-04,
     1         2.129135670286070096D-06,  2.031199981119644866D-09/
 
      DATA A1/  3.063105631929247959D-01,  1.417872685038368678D-01,
     1          2.173189054734066272D-02,  3.585800707573621106D-03,
     1          1.142787213662411011D-04,  8.044697088938151454D-06,
     1          2.092114542066852857D-07, -1.377485462439022186D-09,
     1          7.580209448549789519D-12/
      DATA B1/  1.152813011323656027D+00,  1.370213448778108924D+00,
     1          8.771659692101539598D-01,  3.765170899492643514D-01,
     1          1.157201605837170803D-01,  2.543570598918036107D-02,
     1          3.877159745588877839D-03,  3.391356678944080395D-04,
     1          8.185841691628457454D-06,  7.929929143423822345D-07/
 
      DATA A2/  4.240537001875903744D+01,  7.106121449888719194D+04,
     1          2.644247492013269539D+06,  7.388974981953715144D+08,
     1          8.693570648184380205D+09,  6.684422318513495811D+11,
     1          2.497458768271913493D+11/
      DATA B2/  4.000000000000001628D-01,  1.942954910777370651D+01,
     1          2.852840658155141115D+04,  1.233002624534097401D+06,
     1          3.020327832136588749D+08,  5.298507021546057868D+09,
     1          2.882912998045199982D+11,  1.741052221998644210D+12/
 
 
      IF(X.LT.2.0) THEN
        Y=EXP(X)
        FN=((((((((B(10)*Y+B(9))*Y+B(8))*Y+B(7))*Y+B(6))*Y+B(5))*Y
     1            +B(4))*Y+B(3))*Y+B(2))*Y+B(1)
        FD=((((((((A(9)*Y+A(8))*Y+A(7))*Y+A(6))*Y+A(5))*Y+A(4))*Y+
     1            A(3))*Y+A(2))*Y+A(1))*Y+1
        FERM15=Y*FN/FD
 
      ELSE IF(X.LT.10.0) THEN
        FN=((((((((B1(10)*X+B1(9))*X+B1(8))*X+B1(7))*X+B1(6))*X+
     1            B1(5))*X+B1(4))*X+B1(3))*X+B1(2))*X+B1(1)
        FD=((((((((A1(9)*X+A1(8))*X+A1(7))*X+A1(6))*X+A1(5))*X+A1(4))*X
     1            +A1(3))*X+A1(2))*X+A1(1))*X+1
        FERM15=FN/FD
 
      ELSE
        Y=1./X**2
        FN=((((((B2(8)*Y+B2(7))*Y+B2(6))*Y+B2(5))*Y
     1            +B2(4))*Y+B2(3))*Y+B2(2))*Y+B2(1)
        FD=((((((A2(7)*Y+A2(6))*Y+A2(5))*Y+A2(4))*Y+
     1            A2(3))*Y+A2(2))*Y+A2(1))*Y+1
        FERM15=X**2.5D0*FN/FD
      ENDIF
 
      END
 
C     ----------------------------------------------------
 
C	To calculate the Fermi integral for k=5/2 for real argument
C
C	Required routines : None
 
      FUNCTION FERM25(X)
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION A(9),B(9),A1(9),B1(10),A2(7),B2(8)
 
C	Coefficients of rational function approximations
      DATA A/  2.571894150057574794D+00,  2.583310822362159194D+00,
     1         1.297464965411635611D+00,  3.478951634872978662D-01,
     1         4.953536822731509544D-02,  3.534319266081264567D-03,
     1         1.114660054008188913D-04,  1.196397340523770481D-06,
     1         2.108653816687462637D-09/
      DATA B/  3.323350970447843045D+00,  8.253561418549546218D+00,
     1         7.900830547729824064D+00,  3.709901839066293724D+00,
     1         9.037486960062833711D-01,  1.118605468265125269D-01,
     1         6.453871643985184629D-03,  1.439223289367074978D-04,
     1         7.851354785439239006D-07/
 
      DATA A1/  3.143350423552492924D-01,  1.185925514982136793D-01,
     1          1.507118078811659113D-02,  1.570482413916096774D-03,
     1         -5.595169056590362619D-05, -3.021530267629797655D-06,
     1          2.935920822791014998D-08, -3.139429619713453590D-10,
     1          1.862374323772158779D-12/
      DATA B1/  3.082574389659515354D+00,  3.851032874650932823D+00,
     1          2.542778697192629395D+00,  1.123138726193956412D+00,
     1          3.568215902085525392D-01,  8.321216695003629528D-02,
     1          1.368008186484687443D-02,  1.461373661943904411D-03,
     1          4.840746803030768445D-05, -6.684259889599044773D-06/
 
      DATA A2/ -1.010224365188074094D+02,  6.300193167257369564D+04,
     1         -2.611825140904720814D+06,  6.096057209422390797D+08,
     1         -1.021314648072490935D+10,  7.043216447315414049D+11,
     1         -6.058065587728390704D+11/
      DATA B2/  2.857142857142856463D-01, -2.475121812396447356D+01,
     1          1.758866516117776321D+04, -4.875066917911561303D+05,
     1          1.636558505721404325D+08, -4.202416018195836072D+08,
     1          1.613941002540396296D+11,  2.688699848072963231D+12/
 
 
      IF(X.LT.2.0) THEN
        Y=EXP(X)
        FN=(((((((B(9)*Y+B(8))*Y+B(7))*Y+B(6))*Y+B(5))*Y
     1            +B(4))*Y+B(3))*Y+B(2))*Y+B(1)
        FD=((((((((A(9)*Y+A(8))*Y+A(7))*Y+A(6))*Y+A(5))*Y+A(4))*Y+
     1            A(3))*Y+A(2))*Y+A(1))*Y+1
        FERM25=Y*FN/FD
 
      ELSE IF(X.LT.10.0) THEN
        FN=((((((((B1(10)*X+B1(9))*X+B1(8))*X+B1(7))*X+B1(6))*X+
     1            B1(5))*X+B1(4))*X+B1(3))*X+B1(2))*X+B1(1)
        FD=((((((((A1(9)*X+A1(8))*X+A1(7))*X+A1(6))*X+A1(5))*X+A1(4))*X
     1            +A1(3))*X+A1(2))*X+A1(1))*X+1
        FERM25=FN/FD
 
      ELSE
        Y=1./X**2
        FN=((((((B2(8)*Y+B2(7))*Y+B2(6))*Y+B2(5))*Y
     1            +B2(4))*Y+B2(3))*Y+B2(2))*Y+B2(1)
        FD=((((((A2(7)*Y+A2(6))*Y+A2(5))*Y+A2(4))*Y+
     1            A2(3))*Y+A2(2))*Y+A2(1))*Y+1
        FERM25=X**3.5D0*FN/FD
      ENDIF
 
      END
